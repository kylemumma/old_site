<!DOCTYPE html>
<html>
    <head>
      <title>ml5.js image classifier</title>
      <script src="https://unpkg.com/ml5@0.1.1/dist/ml5.min.js"></script>
      <link rel="stylesheet" type="text/css" href="stylesheet.css"/>
    </head>

  <body>
    <h1>Image classification using MobileNet</h1>
    <p>The MobileNet model labeled this as:<br/>
    <span id="result">...</span><br/>
    <br/>with a confidence of<br/>
    <span id="probability">...</span></p>
    <img src="tigerimg.jpg"
     crossorigin="anonymous" id="image" width="400">
     <p>
       <button type="button" onclick="openPage()">Other Images</button>
     </p>
    
    <script>
      // The image we want to classify
      const image = document.getElementById('image');
      // The result tag in the HTML
      const result = document.getElementById('result');
      // The probability tag in the HTML
      const probability = document.getElementById('probability');

      // Initialize the Image Classifier method with MobileNet
      const classifier = ml5.imageClassifier('MobileNet', function() {
        console.log('Model Loaded!');
      });

      // Make a prediction with the selected image
      // This will return an array with a default of 10 options with their probabilities
      classifier.predict(image, function(err, results) {
        result.innerText = results[0].className;
        probability.innerText = results[0].probability.toFixed(2)*100 + "%";
      });

      function openPage(){
        console.log(result.innerHTML)
        
        var searchWord = result.innerHTML;
        
        if(result.innerHTML.includes(',')){
          for(var i =0; i< result.innerHTML.length; i++){
            if(result.innerHTML.charAt(i) == ","){
              searchWord = result.innerHTML.substring(0, i);
              break;
            }
          }
        }
        
        window.open("https://www.google.com/search?tbm=isch&q=" + searchWord)
      }
    </script>
  </body>
</html>